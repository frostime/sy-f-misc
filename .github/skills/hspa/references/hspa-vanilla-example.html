<!DOCTYPE html>
<html lang="zh-CN">
<!--
    HSPA Vanilla JS Template
    Copy this file as a starting point for simple HSPA pages.
    Best for: low-complexity pages with minimal interactivity.
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Title</title>
    <link rel="stylesheet" href="/plugins/sy-f-misc/styles/hspa-mini.css">
    <style>
        /* Page-specific styles only — use hspa-mini utility classes wherever possible */
    </style>
</head>
<body class="page">
    <div class="page-header">
        <span class="text-bold">Title</span>
        <span class="text-sm text-muted" id="count"></span>
    </div>

    <div class="page-body" id="content">
        <div class="empty-state"><div>加载中...</div></div>
    </div>

    <div class="page-footer">
        <button class="btn btn-primary" id="saveBtn" disabled>保存</button>
    </div>

    <script>
    let sdk = null;

    window.addEventListener('pluginSdkReady', async () => {
        sdk = window.pluginSdk;
        document.documentElement.setAttribute('data-theme-mode', sdk.themeMode);

        try {
            const items = await sdk.getItems();
            render(items);
        } catch (e) {
            sdk.showMessage('加载失败: ' + e.message, 'error');
        }
    });

    function render(items) {
        document.getElementById('count').textContent = items.length + ' 条记录';
        const el = document.getElementById('content');

        if (!items.length) {
            el.innerHTML = '<div class="empty-state"><div>暂无数据</div></div>';
            return;
        }

        el.innerHTML = items.map(item => `
            <div class="card card-hover" style="margin-bottom: var(--sp-2);">
                <div class="flex items-center justify-between">
                    <span class="text-bold">${esc(item.name)}</span>
                    <span class="badge">${esc(item.type)}</span>
                </div>
            </div>
        `).join('');

        document.getElementById('saveBtn').disabled = false;
    }

    function esc(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    </script>
</body>
</html>
