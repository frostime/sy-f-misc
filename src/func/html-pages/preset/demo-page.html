<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single Page Demo</title>
    <style>
        /* ==================== CSS å˜é‡å®šä¹‰ ==================== */
        :root {
            /* å­—ä½“å¤§å°è¯­ä¹‰åŒ– */
            --font-size-normal: var(--font-size, 14px);
            --font-size-large: calc(var(--font-size-normal) * 1.5);
            --font-size-medium: calc(var(--font-size-normal) * 1.1);
            --font-size-small: calc(var(--font-size-normal) * 0.9);
            --font-size-tiny: calc(var(--font-size-normal) * 0.8);

            /* é¢œè‰²è¯­ä¹‰åŒ– - äº®è‰²ä¸»é¢˜ */
            --bg-primary: var(--theme-background, #ffffff);
            --bg-secondary: var(--theme-surface, #f5f5f7);
            --bg-tertiary: var(--theme-surface-light, #fafafa);
            --bg-hover: var(--theme-surface-lighter, #f0f0f0);

            --text-primary: var(--theme-on-background, #333333);
            --text-secondary: var(--theme-on-surface, #666666);
            --text-tertiary: var(--theme-on-surface-light, #999999);

            --accent-color: var(--theme-primary, #d23f31);
            --accent-bg: var(--theme-primary-lightest, #ffe8e6);
            --accent-light: var(--theme-primary-light, #e86c5f);

            --border-color: #e0e0e0;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);

            /* åŠŸèƒ½æ€§é¢œè‰² */
            --success-color: #34a853;
            --error-color: #ea4335;
            --warning-color: #fbbc04;
            --info-color: #4285f4;

            /* é—´è· */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;

            /* åœ†è§’ */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }

        /* æš—è‰²ä¸»é¢˜è¦†ç›– */
        [data-theme-mode="dark"] {
            --border-color: #3e3e42;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.3);

            --success-color: #4caf50;
            --error-color: #f44336;
        }

        /* ==================== å…¨å±€æ ·å¼ ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
            font-size: var(--font-size-normal);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        code,
        pre {
            font-family: var(--font-family-code, "Consolas", "Monaco", monospace);
        }

        /* ==================== å¸ƒå±€ ==================== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }

        .header {
            text-align: center;
            padding: var(--spacing-xl) 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: var(--spacing-xl);
        }

        .header h1 {
            font-size: var(--font-size-large);
            color: var(--accent-color);
            margin-bottom: var(--spacing-sm);
        }

        .header p {
            color: var(--text-secondary);
            font-size: var(--font-size-small);
        }

        .section {
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
        }

        .section-title {
            font-size: var(--font-size-medium);
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 1.2em;
            background: var(--accent-color);
            border-radius: 2px;
        }

        /* ==================== æŒ‰é’® ==================== */
        .btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border: none;
            border-radius: var(--radius-sm);
            font-size: var(--font-size-small);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-group {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        /* ==================== è¡¨å• ==================== */
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-size: var(--font-size-small);
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: var(--font-size-normal);
            font-family: inherit;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
            font-family: var(--font-family-code);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px var(--accent-bg);
        }

        /* ==================== ç»“æœå±•ç¤º ==================== */
        .result-box {
            margin-top: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            max-height: 300px;
            overflow-y: auto;
        }

        .result-box pre {
            margin: 0;
            font-size: var(--font-size-small);
            white-space: pre-wrap;
            word-break: break-all;
        }

        .result-empty {
            color: var(--text-tertiary);
            font-style: italic;
            text-align: center;
            padding: var(--spacing-lg);
        }

        /* ==================== çŠ¶æ€æ ‡ç­¾ ==================== */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: 2px var(--spacing-sm);
            border-radius: 12px;
            font-size: var(--font-size-tiny);
            font-weight: 600;
        }

        .status-success {
            background: var(--success-color);
            color: white;
        }

        .status-error {
            background: var(--error-color);
            color: white;
        }

        .status-info {
            background: var(--info-color);
            color: white;
        }

        /* ==================== åˆ—è¡¨ ==================== */
        .item-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .item {
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .item:hover {
            background: var(--bg-hover);
            border-color: var(--accent-color);
        }

        .item-title {
            font-weight: 500;
            color: var(--text-primary);
        }

        .item-subtitle {
            font-size: var(--font-size-small);
            color: var(--text-tertiary);
        }

        /* ==================== ç½‘æ ¼å¸ƒå±€ ==================== */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-md);
        }

        /* ==================== åŠ è½½çŠ¶æ€ ==================== */
        .loading {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* ==================== å·¥å…·æç¤º ==================== */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: var(--spacing-xs) var(--spacing-sm);
            background: var(--text-primary);
            color: var(--bg-primary);
            font-size: var(--font-size-tiny);
            white-space: nowrap;
            border-radius: var(--radius-sm);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .tooltip:hover::after {
            opacity: 1;
        }

        /* ==================== ä»£ç å— ==================== */
        .code-block {
            background: var(--bg-tertiary);
            padding: var(--spacing-md);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--accent-color);
            overflow-x: auto;
        }

        .code-block code {
            font-size: var(--font-size-small);
            color: var(--text-secondary);
        }

        /* ==================== å“åº”å¼ ==================== */
        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-md);
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸ”Œ HTML Single Page Demo</h1>
            <p>HTML Page åŠŸèƒ½æ¼”ç¤º (window.pluginSdk)</p>
            <div style="margin-top: 12px;">
                <span class="status-badge" id="sdkStatus">
                    <span class="loading"></span> åˆå§‹åŒ–ä¸­...
                </span>
            </div>
        </div>

        <!-- 1. é…ç½®ç®¡ç† -->
        <div class="section">
            <h2 class="section-title">é…ç½®ç®¡ç†</h2>
            <div class="form-group">
                <label class="form-label">é…ç½®é”®</label>
                <input type="text" class="form-input" id="configKey" placeholder="ä¾‹å¦‚: theme">
            </div>
            <div class="form-group">
                <label class="form-label">é…ç½®å€¼</label>
                <input type="text" class="form-input" id="configValue" placeholder="ä¾‹å¦‚: dark">
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
                <button class="btn btn-secondary" onclick="loadConfig()">ğŸ“‚ åŠ è½½é…ç½®</button>
            </div>
            <div class="result-box" id="configResult">
                <div class="result-empty">é…ç½®ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            </div>
        </div>

        <!-- 2. ç¬”è®°æœ¬æ“ä½œ -->
        <div class="section">
            <h2 class="section-title">ç¬”è®°æœ¬åˆ—è¡¨</h2>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="listNotebooks()">ğŸ“š è·å–ç¬”è®°æœ¬</button>
            </div>
            <div class="item-list" id="notebookList" style="margin-top: 16px;">
                <div class="result-empty">ç‚¹å‡»æŒ‰é’®åŠ è½½ç¬”è®°æœ¬</div>
            </div>
        </div>

        <!-- 3. SQL æŸ¥è¯¢ -->
        <div class="section">
            <h2 class="section-title">SQL æŸ¥è¯¢</h2>
            <div class="form-group">
                <label class="form-label">SQL è¯­å¥</label>
                <textarea class="form-textarea" id="sqlQuery"
                    placeholder="SELECT * FROM blocks WHERE type='d' LIMIT 10">SELECT * FROM blocks WHERE type='d' ORDER BY updated DESC LIMIT 10</textarea>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="executeSQL()">ğŸ” æ‰§è¡ŒæŸ¥è¯¢</button>
                <button class="btn btn-secondary" onclick="loadSQLExample()">ğŸ“‹ åŠ è½½ç¤ºä¾‹</button>
            </div>
            <div class="result-box" id="sqlResult">
                <div class="result-empty">æŸ¥è¯¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            </div>
        </div>

        <!-- 4. å—æ“ä½œ -->
        <div class="section">
            <h2 class="section-title">å—æ“ä½œ</h2>
            <div class="grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">å— ID</label>
                        <input type="text" class="form-input" id="blockId" placeholder="20210808180117-6v0mkxr">
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="getBlock()">ğŸ“„ è·å–å—</button>
                        <button class="btn btn-secondary" onclick="getMarkdown()">ğŸ“ è·å– Markdown</button>
                        <button class="btn btn-secondary" onclick="openBlock()">ğŸ”— æ‰“å¼€å—</button>
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label class="form-label">æ–‡æ¡£ ID (æŸ¥è¯¢å­æ–‡æ¡£)</label>
                        <input type="text" class="form-input" id="docId" placeholder="æ–‡æ¡£ ID">
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="getChildDocs()">ğŸ“‚ å­æ–‡æ¡£</button>
                        <button class="btn btn-secondary" onclick="getBacklinks()">ğŸ”— åé“¾</button>
                    </div>
                </div>
            </div>
            <div class="result-box" id="blockResult">
                <div class="result-empty">å—ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            </div>
        </div>

        <!-- 5. API è¯·æ±‚ -->
        <div class="section">
            <h2 class="section-title">API è¯·æ±‚æ¼”ç¤º</h2>
            <div class="form-group">
                <label class="form-label">API ç«¯ç‚¹</label>
                <input type="text" class="form-input" id="apiEndpoint" value="/api/system/version"
                    placeholder="/api/...">
            </div>
            <div class="form-group">
                <label class="form-label">è¯·æ±‚æ•°æ® (JSON)</label>
                <textarea class="form-textarea" id="apiData" placeholder='{"key": "value"}'>{}</textarea>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="callAPI()">ğŸš€ å‘é€è¯·æ±‚</button>
                <button class="btn btn-secondary" onclick="loadAPIExample()">ğŸ“‹ ç³»ç»Ÿç‰ˆæœ¬ç¤ºä¾‹</button>
            </div>
            <div class="result-box" id="apiResult">
                <div class="result-empty">API å“åº”å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            </div>
        </div>

        <!-- 6. UI ç»„ä»¶ -->
        <div class="section">
            <h2 class="section-title">UI ç»„ä»¶æ¼”ç¤º</h2>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="showSuccessMsg()">âœ… æˆåŠŸæ¶ˆæ¯</button>
                <button class="btn btn-primary" onclick="showErrorMsg()">âŒ é”™è¯¯æ¶ˆæ¯</button>
                <button class="btn btn-secondary" onclick="showCustomDialog()">ğŸ’¬ è‡ªå®šä¹‰å¯¹è¯æ¡†</button>
                <button class="btn btn-secondary" onclick="showInputDialog()">âœï¸ è¾“å…¥å¯¹è¯æ¡†</button>
            </div>
        </div>

        <!-- 7. ä¸»é¢˜ä¿¡æ¯ -->
        <div class="section">
            <h2 class="section-title">ä¸»é¢˜ä¸æ ·å¼</h2>
            <div class="code-block" id="themeInfo">
                <code>åŠ è½½ä¸­...</code>
            </div>
        </div>
    </div>

    <script>
        let sdk = null;

        // ==================== åˆå§‹åŒ– ====================
        window.addEventListener('pluginSdkReady', async () => {
            sdk = window.pluginSdk;

            // è®¾ç½®ä¸»é¢˜æ¨¡å¼
            const themeMode = sdk.themeMode || 'light';
            document.documentElement.setAttribute('data-theme-mode', themeMode);

            // æ›´æ–°çŠ¶æ€
            const statusEl = document.getElementById('sdkStatus');
            statusEl.className = 'status-badge status-success';
            statusEl.innerHTML = 'âœ“ SDK å·²å°±ç»ª';

            // æ˜¾ç¤ºä¸»é¢˜ä¿¡æ¯
            displayThemeInfo();

            console.log('SDK å·²åˆå§‹åŒ–', sdk);
        });

        // ==================== è¾…åŠ©å‡½æ•° ====================
        function displayResult(elementId, data, error = false) {
            const el = document.getElementById(elementId);
            if (!data && !error) {
                el.innerHTML = '<div class="result-empty">æ— æ•°æ®</div>';
                return;
            }

            const content = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
            el.innerHTML = `<pre>${escapeHtml(content)}</pre>`;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function checkSDK() {
            if (!sdk) {
                alert('SDK å°šæœªåˆå§‹åŒ–ï¼Œè¯·ç¨å€™é‡è¯•');
                return false;
            }
            return true;
        }

        // ==================== é…ç½®ç®¡ç† ====================
        async function saveConfig() {
            if (!checkSDK()) return;

            const key = document.getElementById('configKey').value.trim();
            const value = document.getElementById('configValue').value.trim();

            if (!key) {
                sdk.showMessage('è¯·è¾“å…¥é…ç½®é”®', 'error');
                return;
            }

            try {
                const currentConfig = await sdk.loadConfig();
                currentConfig[key] = value;
                await sdk.saveConfig(currentConfig);

                sdk.showMessage('é…ç½®å·²ä¿å­˜', 'info');
                displayResult('configResult', currentConfig);
            } catch (err) {
                sdk.showMessage('ä¿å­˜å¤±è´¥: ' + err.message, 'error');
                displayResult('configResult', err.message, true);
            }
        }

        async function loadConfig() {
            if (!checkSDK()) return;

            try {
                const config = await sdk.loadConfig();
                displayResult('configResult', config);
                sdk.showMessage('é…ç½®å·²åŠ è½½', 'info');
            } catch (err) {
                sdk.showMessage('åŠ è½½å¤±è´¥: ' + err.message, 'error');
                displayResult('configResult', err.message, true);
            }
        }

        // ==================== ç¬”è®°æœ¬æ“ä½œ ====================
        async function listNotebooks() {
            if (!checkSDK()) return;

            try {
                const notebooks = sdk.lsNotebooks();
                const listEl = document.getElementById('notebookList');

                if (!notebooks || notebooks.length === 0) {
                    listEl.innerHTML = '<div class="result-empty">æœªæ‰¾åˆ°ç¬”è®°æœ¬</div>';
                    return;
                }

                listEl.innerHTML = notebooks.map(nb => `
                    <div class="item">
                        <div>
                            <div class="item-title">${escapeHtml(nb.name)}</div>
                            <div class="item-subtitle">ID: ${nb.id}</div>
                        </div>
                        <span class="status-badge ${nb.closed ? 'status-error' : 'status-success'}">
                            ${nb.closed ? 'å·²å…³é—­' : 'å·²æ‰“å¼€'}
                        </span>
                    </div>
                `).join('');

                sdk.showMessage(`æ‰¾åˆ° ${notebooks.length} ä¸ªç¬”è®°æœ¬`, 'info');
            } catch (err) {
                sdk.showMessage('è·å–å¤±è´¥: ' + err.message, 'error');
            }
        }

        // ==================== SQL æŸ¥è¯¢ ====================
        async function executeSQL() {
            if (!checkSDK()) return;

            const query = document.getElementById('sqlQuery').value.trim();
            if (!query) {
                sdk.showMessage('è¯·è¾“å…¥ SQL æŸ¥è¯¢è¯­å¥', 'error');
                return;
            }

            try {
                const results = await sdk.querySQL(query);
                displayResult('sqlResult', results);
                sdk.showMessage(`æŸ¥è¯¢æˆåŠŸï¼Œè¿”å› ${results?.length || 0} æ¡ç»“æœ`, 'info');
            } catch (err) {
                sdk.showMessage('æŸ¥è¯¢å¤±è´¥: ' + err.message, 'error');
                displayResult('sqlResult', err.message, true);
            }
        }

        function loadSQLExample() {
            document.getElementById('sqlQuery').value =
                "SELECT id, content, hpath, type, updated\n" +
                "FROM blocks\n" +
                "WHERE type = 'd'\n" +
                "ORDER BY updated DESC\n" +
                "LIMIT 10";
        }

        // ==================== å—æ“ä½œ ====================
        async function getBlock() {
            if (!checkSDK()) return;

            const blockId = document.getElementById('blockId').value.trim();
            if (!blockId) {
                sdk.showMessage('è¯·è¾“å…¥å— ID', 'error');
                return;
            }

            try {
                const block = await sdk.getBlockByID(blockId);
                displayResult('blockResult', block);
                sdk.showMessage('è·å–æˆåŠŸ', 'info');
            } catch (err) {
                sdk.showMessage('è·å–å¤±è´¥: ' + err.message, 'error');
                displayResult('blockResult', err.message, true);
            }
        }

        async function getMarkdown() {
            if (!checkSDK()) return;

            const blockId = document.getElementById('blockId').value.trim();
            if (!blockId) {
                sdk.showMessage('è¯·è¾“å…¥å— ID', 'error');
                return;
            }

            try {
                const markdown = await sdk.getMarkdown(blockId);
                displayResult('blockResult', markdown);
                sdk.showMessage('è·å–æˆåŠŸ', 'info');
            } catch (err) {
                sdk.showMessage('è·å–å¤±è´¥: ' + err.message, 'error');
                displayResult('blockResult', err.message, true);
            }
        }

        function openBlock() {
            if (!checkSDK()) return;

            const blockId = document.getElementById('blockId').value.trim();
            if (!blockId) {
                sdk.showMessage('è¯·è¾“å…¥å— ID', 'error');
                return;
            }

            try {
                sdk.openBlock(blockId);
                sdk.showMessage('å·²è¯·æ±‚æ‰“å¼€å—', 'info');
            } catch (err) {
                sdk.showMessage('æ‰“å¼€å¤±è´¥: ' + err.message, 'error');
            }
        }

        async function getChildDocs() {
            if (!checkSDK()) return;

            const docId = document.getElementById('docId').value.trim();
            if (!docId) {
                sdk.showMessage('è¯·è¾“å…¥æ–‡æ¡£ ID', 'error');
                return;
            }

            try {
                const children = await sdk.queryChildDocs(docId);
                displayResult('blockResult', children);
                sdk.showMessage(`æ‰¾åˆ° ${children?.length || 0} ä¸ªå­æ–‡æ¡£`, 'info');
            } catch (err) {
                sdk.showMessage('æŸ¥è¯¢å¤±è´¥: ' + err.message, 'error');
                displayResult('blockResult', err.message, true);
            }
        }

        async function getBacklinks() {
            if (!checkSDK()) return;

            const blockId = document.getElementById('blockId').value.trim();
            if (!blockId) {
                sdk.showMessage('è¯·è¾“å…¥å— ID', 'error');
                return;
            }

            try {
                const backlinks = await sdk.queryBacklinks(blockId);
                displayResult('blockResult', backlinks);
                sdk.showMessage(`æ‰¾åˆ° ${backlinks?.length || 0} ä¸ªåé“¾`, 'info');
            } catch (err) {
                sdk.showMessage('æŸ¥è¯¢å¤±è´¥: ' + err.message, 'error');
                displayResult('blockResult', err.message, true);
            }
        }

        // ==================== API è¯·æ±‚ ====================
        async function callAPI() {
            if (!checkSDK()) return;

            const endpoint = document.getElementById('apiEndpoint').value.trim();
            if (!endpoint) {
                sdk.showMessage('è¯·è¾“å…¥ API ç«¯ç‚¹', 'error');
                return;
            }

            let data = {};
            const dataStr = document.getElementById('apiData').value.trim();
            if (dataStr) {
                try {
                    data = JSON.parse(dataStr);
                } catch (err) {
                    sdk.showMessage('JSON æ ¼å¼é”™è¯¯', 'error');
                    return;
                }
            }

            try {
                const result = await sdk.request(endpoint, data);
                displayResult('apiResult', result);
                sdk.showMessage('è¯·æ±‚æˆåŠŸ', 'info');
            } catch (err) {
                sdk.showMessage('è¯·æ±‚å¤±è´¥: ' + err.message, 'error');
                displayResult('apiResult', err.message, true);
            }
        }

        function loadAPIExample() {
            document.getElementById('apiEndpoint').value = '/api/system/version';
            document.getElementById('apiData').value = '{}';
        }

        // ==================== UI ç»„ä»¶ ====================
        function showSuccessMsg() {
            if (!checkSDK()) return;
            sdk.showMessage('è¿™æ˜¯ä¸€æ¡æˆåŠŸæ¶ˆæ¯ï¼', 'info', 2000);
        }

        function showErrorMsg() {
            if (!checkSDK()) return;
            sdk.showMessage('è¿™æ˜¯ä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼', 'error', 2000);
        }

        function showCustomDialog() {
            if (!checkSDK()) return;

            const content = document.createElement('div');
            content.style.padding = '20px';
            content.innerHTML = `
                <p style="margin-bottom: 12px;">è¿™æ˜¯è‡ªå®šä¹‰å¯¹è¯æ¡†çš„å†…å®¹ã€‚</p>
                <p style="color: var(--text-secondary); font-size: var(--font-size-small);">
                    ä½ å¯ä»¥åœ¨è¿™é‡Œæ”¾ç½®ä»»ä½• HTML å…ƒç´ ã€‚
                </p>
            `;

            const dialog = sdk.showDialog({
                title: 'è‡ªå®šä¹‰å¯¹è¯æ¡†',
                ele: content,
                width: '500px',
                afterClose: () => {
                    console.log('å¯¹è¯æ¡†å·²å…³é—­');
                }
            });

            console.log('å¯¹è¯æ¡†å·²æ‰“å¼€', dialog);
        }

        function showInputDialog() {
            if (!checkSDK()) return;

            sdk.inputDialog({
                title: 'è¾“å…¥å¯¹è¯æ¡†',
                defaultText: 'è¯·è¾“å…¥å†…å®¹',
                confirm: (text) => {
                    sdk.showMessage(`ä½ è¾“å…¥äº†: ${text}`, 'info');
                },
                cancel: () => {
                    sdk.showMessage('å·²å–æ¶ˆ', 'info');
                },
                type: 'textline'
            });
        }

        // ==================== ä¸»é¢˜ä¿¡æ¯ ====================
        function displayThemeInfo() {
            if (!checkSDK()) return;

            const vars = sdk.styleVar;
            const info = `ä¸»é¢˜æ¨¡å¼: ${sdk.themeMode}

### ä¸»è¦æ ·å¼å˜é‡

- å­—ä½“: ${vars['font-family']}
- å­—å·: ${vars['font-size']}
- ä»£ç å­—ä½“: ${vars['font-family-code']}

- ä¸»é¢˜è‰²: ${vars['theme-primary']}
- èƒŒæ™¯è‰²: ${vars['theme-background']}
- è¡¨é¢è‰²: ${vars['theme-surface']}
- æ–‡å­—è‰²: ${vars['theme-on-background']}`;

            const html = sdk.lute.Md2HTML(info);
            document.getElementById('themeInfo').innerHTML = html;
        }
    </script>
</body>

</html>